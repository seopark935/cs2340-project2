{% extends "base.html" %}
{% block content %}
<div class="container py-4">
  <h2>Edit My Profile</h2>
  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {{ template_data.form.non_field_errors }}
    {% for field in template_data.form %}
      <div class="mb-3">
        <label class="form-label">{{ field.label }}</label>
        {{ field }}
        {% if field.help_text %}
          <div class="form-text">{{ field.help_text }}</div>
        {% endif %}
        {% for error in field.errors %}
          <div class="text-danger">{{ error }}</div>
        {% endfor %}
      </div>
    {% endfor %}

    <h5 class="mt-3">Experience</h5>
    <div>
    {% for experience in template_data.jobSeeker.experience.all %}
        <div class="col-md-8 col-12 mb-5">
          <div class="fw-semibold lh-sm fs-5 text-truncate" style="max-width: 500px;">
            {{ experience.name }} | {% if not template_data.jobSeeker.hide_location %} {{ experience.location }} {% endif %}
          </div>
          <div class="text-body-secondary my-1 lh-sm mb-3">
            {% if experience.endDate == "" %}
              Since {{ experience.startDate }}
            {% else %}
              {{ experience.startDate }} - {{ experience.endDate }}
            {% endif %}
          </div>
          <div class="my-1 lh-sm mb-3">
            {{ experience.description }}
          </div>
        </div>
    {% empty %}
      <p>No experiences listed.</p>
    {% endfor %}
    </div>

    <h5 class="mt-5">Skills</h5>
    <div>
      {% for skill in template_data.jobSeeker.skills.all %}
      <div class="col-md-8 col-12 mb-2">
        <span class="badge bg-secondary">{{ skill.name }}</span>
      </div>
      {% empty %}
        <p>No skills listed.</p>
      {% endfor %}
    </div>

    <h5 class="mt-5">Links</h5>
    <div>
      {% for link in template_data.jobSeeker.links.all %}
        <a href="{{ link.url }}" target="_blank">{{ link.url }}</a>
      {% empty %}
        <p>No links listed.</p>
      {% endfor %}
    </div>
    
    <button class="btn btn-dark mt-5" type="submit">Save Changes</button>
    <a href="{% url 'jobSeekers.my_profile' %}" class="btn btn-outline-secondary mt-5">Cancel</a>
  </form>
  </div>

  <div class="container py-3">
    <div class="col-md-3 mt-3 mb-3">
      <h5>Add New Skill</h5>
      
      <form method="post" action="{% url 'jobSeekers.add_skill' %}" class="col-md-8">
        {% csrf_token %}
        <input name="name" class="form-control" placeholder="Enter New Skill" required>
        <button class="btn btn-primary w-50" type="submit">Add</button>
      </form>
    </div>
  </div>

  <div class="container py-3">
    <div class="col-md-3 mt-3 mb-3">
      <h5>Add New Link</h5>
      
      <form method="post" action="{% url 'jobSeekers.add_link' %}" class="col-md-8">
        {% csrf_token %}
        <input name="name" class="form-control" placeholder="Enter New Link" required>
        <button class="btn btn-primary w-50" type="submit">Add</button>
      </form>
    </div>
  </div>

  <div class="container py-3">
    <div class="col-md-3 mt-3 mb-3">
      <h5>Add New Experience</h5>
      
      <form method="post" action="{% url 'jobSeekers.add_experience' %}" class="col-md-8">
        {% csrf_token %}
        <input name="name" class="form-control" placeholder="Company Name" required>
        <input name="location" class="form-control" placeholder="Company Location" required>
        <input name="startDate" class="form-control" placeholder="Start Date" required>
        <input name="endDate" class="form-control" placeholder="End Date (leave blank if still working)" required>
        <input name="description" class="form-control" placeholder="Description" required>
        <button class="btn btn-primary w-50" type="submit">Add</button>
      </form>
    </div>
  </div>
{% endblock %}
