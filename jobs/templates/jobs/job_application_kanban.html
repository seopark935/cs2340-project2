{% extends 'base.html' %}

{% block title %}{{ job.title }} Applications{% endblock %}

{% block content %}
<h1 style="font-size:1.5rem;">{{ job.title }} Applications</h1>

<div style="display:flex; gap:1rem; align-items:flex-start;">
    {% for status, apps in kanban_columns.items %}
    <div style="flex:1; border:1px solid #ccc; padding:1rem; border-radius:8px; background:#f0f0f0;">
        <h2 style="font-size:1.2rem; margin-bottom:0.5rem;">
            {% for value, label in status_choices %}
                {% if value == status %}
                    {{ label }}
                {% endif %}
            {% endfor %}
        </h2>
        

        {% if apps %}
            {% for app in apps %}
            <div style="border:1px solid #999; padding:0.5rem; margin-bottom:0.5rem; border-radius:4px; background:#fff; font-size:0.9rem;">
                <strong>{{ app.user.username }}</strong><br>
                {{ app.message|truncatewords:10 }}

                <!-- Form to update status -->
                <form method="POST" action="{% url 'update_status' application_id=app.id %}" style="margin-top:0.3rem;">
                    {% csrf_token %}
                    <select name="status">
                        {% for value, label in status_choices %}
                            <option value="{{ value }}" {% if value == app.status %}selected{% endif %}>{{ label }}</option>
                        {% endfor %}
                    </select>
                    <button type="submit" style="margin-left:0.3rem;">Update</button>
                </form>
                
                
            </div>
            {% endfor %}
        {% else %}
            <p style="font-size:0.9rem; color:#555;">No applications</p>
        {% endif %}
    </div>
    {% endfor %}
</div>
{% endblock %}
